import React from 'react';
import useTheme from '@mui/styles/useTheme';
import makeStyles from '@mui/styles/makeStyles';
import Grid from '@mui/material/Grid';
import Typography from '@mui/material/Typography';

const viewBoxParams = { w: 463.729, h: 463.729 };

const useStyles = makeStyles({
  maskRect: {
    height: ({ height }) => `${height}%`,
  }
});

const PourProgress = ({ size = 400, progress = 0, color, fillColor }) => {
  const height = Math.max(progress - 5, 0);
  const classes = useStyles({ height });
  const { palette } = useTheme();

  return (
    <Grid position="relative">
      <svg viewBox={`0 0 ${viewBoxParams.w} ${viewBoxParams.h}`} height={size}>
        <defs>
          <mask id="beer-mask">
            <rect
              height={40}
              x={-viewBoxParams.w}
              y={-viewBoxParams.h}
              width={viewBoxParams.w}
              transform={`rotate(-180)`}
              className={classes.maskRect}
              fill={fillColor || palette.primary.light}
            />
          </mask>
        </defs>

        <path
          fill={color || palette.primary.dark}
          d="M290.904,212.333c-3.892-8.471-10.103-16.768-12.44-19.891c-0.292-0.391-0.505-0.672-0.622-0.839   c-0.061-0.089-0.155-0.221-0.282-0.396c-3.396-4.691-9.094-14.586-9.094-28.143c0-17.626-1.373-50.397-3.592-72.604   c-0.928-9.335-1.833-18.618-2.561-26.076c-0.701-7.183-1.099-11.256-1.349-13.634c1.513-1.991,2.716-4.048,2.716-6.509   c0-1.196-0.313-2.962-2.093-11.812c-0.168-0.832-0.353-1.751-0.534-2.66c0.735-0.546,1.349-1.257,1.775-2.082   c1.392-2.691,1.467-12.742-0.906-17.884C259.143,3.757,252.941,0,245.737,0h-27.748c-7.209,0-13.413,3.758-16.189,9.803   c-2.376,5.166-2.285,15.22-0.884,17.904c0.426,0.815,1.033,1.518,1.76,2.059c-0.178,0.891-0.359,1.789-0.523,2.605   c-1.795,8.896-2.11,10.672-2.11,11.872c0,2.474,1.206,4.532,2.725,6.521c-0.231,2.213-0.591,5.894-1.205,12.186   c-0.749,7.682-1.714,17.567-2.706,27.512c-2.218,22.3-3.59,55.05-3.59,72.604c0,13.562-5.694,23.455-9.088,28.146   c-0.126,0.174-0.22,0.306-0.286,0.401c-0.111,0.159-0.325,0.441-0.618,0.833c-2.337,3.122-8.546,11.418-12.444,19.885   c-4.588,9.97-4.031,23.751-3.929,25.671c0.015,6.101,0.396,168.259,0.398,178.069c-0.569,23.58,2.627,35.377,11.022,40.667   c9.941,6.486,41.949,6.992,51.542,6.992c9.595,0,41.608-0.505,51.545-6.994c8.396-5.294,11.589-17.088,11.012-40.666   c0.002-10.254,0.391-171.945,0.406-178.066C294.93,236.078,295.492,222.292,290.904,212.333z M282.839,237.437   c-0.008,0.124-0.013,0.247-0.013,0.371c-0.004,1.686-0.406,168.661-0.406,178.334c0,0.05,0.001,0.1,0.002,0.148   c0.543,21.905-2.656,28.571-5.436,30.307c-0.046,0.029-0.092,0.059-0.138,0.089c-3.688,2.444-20.706,5.043-44.985,5.043   s-41.298-2.599-44.985-5.043c-0.046-0.03-0.092-0.06-0.139-0.089c-2.778-1.734-5.977-8.399-5.442-30.309   c0.001-0.049,0.002-0.098,0.002-0.146c0-9.179-0.395-176.643-0.398-178.334c0-0.123-0.004-0.246-0.013-0.368   c-0.217-3.399-0.131-13.634,2.842-20.092c3.366-7.313,9.023-14.868,11.151-17.713c0.457-0.611,0.774-1.041,0.892-1.214l0.127-0.177   c4.245-5.866,11.366-18.237,11.366-35.18c0-17.269,1.35-49.483,3.531-71.415c0.993-9.952,1.958-19.847,2.708-27.536   c0.669-6.849,1.25-12.813,1.392-14.062c0.506-2.745-1.094-4.709-1.899-5.699c-0.181-0.221-0.498-0.61-0.775-0.978   c0.364-2.049,1.139-5.889,1.692-8.632c2.01-9.966,2.01-9.966,1.323-11.788c-0.597-1.583-1.809-2.793-3.291-3.416   c0.073-1.824,0.299-3.728,0.756-4.724c0.954-2.077,3.444-2.814,5.286-2.814h27.748c1.928,0,4.328,0.74,5.286,2.824   c0.456,0.988,0.682,2.891,0.756,4.717c-1.464,0.618-2.665,1.809-3.267,3.369c-0.71,1.841-0.71,1.841,1.311,11.887   c0.548,2.726,1.315,6.538,1.678,8.577c-0.277,0.368-0.594,0.76-0.773,0.981c-0.805,0.996-2.398,2.967-1.889,5.705   c0.151,1.343,0.793,7.928,1.531,15.489c0.729,7.464,1.635,16.755,2.563,26.101c2.183,21.842,3.533,54.075,3.533,71.414   c0,16.939,7.126,29.313,11.374,35.18l0.101,0.138c0.144,0.211,0.46,0.641,0.917,1.252c2.129,2.844,7.784,10.397,11.145,17.715   C282.954,223.757,283.05,234.027,282.839,237.437z"
        />

        <path
          mask="url(#beer-mask)"
          fill={fillColor || palette.primary.light}
          d="m 280.07815,224.59554 c -0.0188,-3.09091 -25.64821,-39.57639 -25.68151,-50.81294 -0.10303,-34.4369 0.0198,8.12301 -0.80765,-51.48967 -0.20924,-15.07407 -5.04819,-70.07425 -8.84032,-70.14828 l -25.24409,-0.492818 c -3.79327,-0.07405 -8.84032,58.538678 -8.84032,73.597998 0,93.23783 -0.21293,10.14878 -0.31482,44.59022 -0.0332,11.23655 -26.13684,51.66929 -26.17432,54.75549 l -0.98564,81.14663 c -0.003,91.59688 -0.004,125.87014 7.79065,135.47938 5.50784,6.78647 23.29181,10.20926 37.52106,10.51835 h 6.758 0.0378 c 14.19146,-0.30909 31.97544,-3.73188 37.48442,-10.51835 7.79408,-9.60469 7.79294,-43.87796 7.78951,-135.47938 z"
        />
      </svg>

      {!!progress && (
        <Grid position="absolute" top="55%" left="47%" zIndex={10}>
          <Typography>{progress}%</Typography>
        </Grid>
      )}
    </Grid>
  )
};

export default PourProgress;
